---
title: "Strawberry PDF Document"
author: "Group 3: Rose Determan, Yongrong Chai, Wuji Shan, Tong Sun"
date: "11/03/2021"
output: pdf_document
---
*from assignment: * Using R, produce a pdf document presenting your results. The
document should be structured with appropriate headings, tables, plots, images, 
and maps. Make sure to include citations. 

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load("tidyverse","knitr","kableExtra","ggplot2", "ggbiplot")
options(warn = -1)
```

```{r, include=FALSE}
source("wrangling.R", echo=TRUE)
source("figure_functions.R", echo = TRUE)
```


![Strawberries](strawberry.jpg)
\newpage

# 1. Introduction

In this project, we use the data sets strawberries, insecticides, and herbicides-fungicides-other from USDA. We first wrangled these files, finished data cleaning and organizing the final data set; then we start to visualize and explore the data. This report focus on 2 main parts: Data cleaning and EDA.

- Data cleaning: We wrangle the data sets strawberries, insecticides, and herbicides-fungicides-other. Separate some columns and eliminate the redundancy.
- EDA: We plot a pie chart with a proportion of dataset by states, maps of comparison of strawberry yields and pesticide application between states and years, and a dot plot of the relationship between the level of Bee Toxicity and Carcinogen level.

Besides, we deploy a shiny app [Shiny_strawberries](https://rongli.shinyapps.io/shiny/) for data display and exploration.


# 2. EDA -- We added mouse over into our plots.

# 2.1 Show a pie chart with proportion in number of three states: CA, FL, WA
```{r, include = TRUE}
state_fig()
```
The proportions of strawberries numbers have a significant difference between states. California has the largest share, and Washington has the smallest one. (CA > FL > WA)  

# 2.2 Show a map of Strawberries Yield measured in CWT/Acre
```{r, include = TRUE}
map.straw(strawb_yield[strawb_yield$Data.Item == "STRAWBERRIES - YIELD, MEASURED IN CWT / ACRE",], "Strawberries Yield (CWT/Acre))\n2015-2020")
```


# 2.3 Show a map of average number of pesticide application
```{r, include = TRUE}
map.straw(df.num,"Average Number of Pesticide Applications \n2016 2018 2019")
```


# 2.4 Show the correlation of average number of Bee Toxicity measured in applications and carcinogen level
```{r,include = TRUE}
ggplot(df.num,aes(color=as.factor(toxicity_bee), y=Value, x=carcinogen)) + 
   xlab("Carcinogen Level")+
   ylab("Average Number of Applications") + 
   scale_color_discrete(name = "Bee Toxicity")+
   geom_jitter(width = 0.1)
```
From this graph, we can get the interesting finding that all strawberries measured in number with toxicity_bee exist with slight level of carcinogen. There does not exist strawberries measured in number with toxicity_bee in the 2 (medium) and 3 (high) level of carcinogen.  


# 3. Reference

https://quickstats.nass.usda.gov/#56E84525-1350-34A1-9ED7-27363BD5A7D3


